---
keywords: fastai
title: Predicting happiness of Cypriots
hide: true
toc: true
comments: true
categories: [python, stats]
nb_path: _notebooks/3333-01-01-handson-examples.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/3333-01-01-handson-examples.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examples from the hands on machine learning <a href="https://github.com/ageron/handson-ml2">book</a> by Aur√©lien Geron.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">load_bli</span><span class="p">():</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/oecd-bli.csv&#39;</span><span class="p">,</span> <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">]]</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;LOCATION&#39;</span><span class="p">:</span> <span class="s1">&#39;country_code&#39;</span><span class="p">})</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;country_code&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">],</span> <span class="s1">&#39;Indicator&#39;</span><span class="p">)</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="p">[[</span><span class="s1">&#39;Life satisfaction&#39;</span><span class="p">]]</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Life satisfaction&#39;</span><span class="p">:</span> <span class="s1">&#39;life_satisfaction&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">bli</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">load_gdp</span><span class="p">():</span>
    <span class="n">gdppc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/oecd-gdppc.csv&#39;</span><span class="p">,</span> <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">gdppc</span> <span class="o">=</span> <span class="n">gdppc</span><span class="p">[</span><span class="n">gdppc</span><span class="o">.</span><span class="n">TIME</span> <span class="o">==</span> <span class="mi">2019</span><span class="p">]</span>
    <span class="n">gdppc</span> <span class="o">=</span> <span class="n">gdppc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>
    <span class="n">gdppc</span> <span class="o">=</span> <span class="n">gdppc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;country_code&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;gdppc&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">gdppc</span><span class="p">[[</span><span class="s1">&#39;country_code&#39;</span><span class="p">,</span> <span class="s1">&#39;gdppc&#39;</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">make_dataset</span><span class="p">(</span><span class="n">bli</span><span class="p">,</span> <span class="n">gdppc</span><span class="p">):</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gdppc</span><span class="p">)</span>
    <span class="n">bli</span> <span class="o">=</span> <span class="n">bli</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;gdppc&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">drop_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">keep_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">bli</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">drop_idx</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">bli</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">keep_idx</span><span class="p">]</span>

<span class="n">bli</span> <span class="o">=</span> <span class="n">load_bli</span><span class="p">()</span>
<span class="n">gdppc</span> <span class="o">=</span> <span class="n">load_gdp</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">make_dataset</span><span class="p">(</span><span class="n">bli</span><span class="p">,</span> <span class="n">gdppc</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;gdppc&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;life_satisfaction&#39;</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country_code</th>
      <th>country</th>
      <th>life_satisfaction</th>
      <th>gdppc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17</th>
      <td>IRL</td>
      <td>Ireland</td>
      <td>7.05</td>
      <td>90140.764256</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CHE</td>
      <td>Switzerland</td>
      <td>7.50</td>
      <td>70485.014502</td>
    </tr>
    <tr>
      <th>28</th>
      <td>NOR</td>
      <td>Norway</td>
      <td>7.62</td>
      <td>69169.203192</td>
    </tr>
    <tr>
      <th>38</th>
      <td>USA</td>
      <td>United States</td>
      <td>7.00</td>
      <td>65126.619982</td>
    </tr>
    <tr>
      <th>27</th>
      <td>NLD</td>
      <td>Netherlands</td>
      <td>7.50</td>
      <td>59419.863105</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plot relationship of interest</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;gdppc&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;life_satisfaction&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model and predict</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="n">cyprus_gdp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">22_587</span><span class="p">]]</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Linear regression:  </span><span class="si">{</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cyprus_gdp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">knn1</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">knn1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN, k=1:           </span><span class="si">{</span><span class="n">knn1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cyprus_gdp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">knn3</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">knn3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN, k=3:           </span><span class="si">{</span><span class="n">knn3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cyprus_gdp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Linear regression:  5.9
KNN, k=1:           6.5
KNN, k=3:           6.2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

